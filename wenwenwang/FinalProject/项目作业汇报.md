# Project 7: 基于图像的细胞形态分类 - 作业汇报

**汇报人：王雯雯 20251201172**

## 项目概述

本项目旨在通过机器学习方法对细胞形态进行分类，探索不同细胞类型或状态的形态特征差异。项目采用了完整的机器学习流程，从数据预处理到模型训练与评估，实现了对细胞形态特征的自动化分类。

---

## 1. 生物学背景与研究意义

### 1.1 研究背景
细胞的**形状（shape）** 与**纹理（texture）** 是反映其生物状态的关键信息载体：
- **细胞周期阶段**：分裂期细胞的纺锤体形态 vs 间期细胞的圆形特征
- **健康/病变状态**：正常上皮细胞的规则形态 vs 癌细胞的异型性形态
- **药物响应**：药物作用后细胞体积、纹理的变化

### 1.2 研究意义
传统人工观察存在效率低、主观性强、误差大的问题，而自动化图像分析技术可以：
- 定量提取细胞形态特征
- 标准化分析流程，减少人为干扰
- 支撑大规模细胞样本的快速筛查

---

## 2. 核心研究问题

**能否通过机器学习分类器，基于从显微镜图像中提取的定量形态特征，准确区分不同的细胞类型或细胞状态？**

本质上是将高维形态特征转化为可解释的细胞类别/状态标签，为细胞生物学研究、疾病诊断、药物筛选提供自动化技术支撑。

---

## 3. 数据集与方法

### 3.1 数据来源
使用 CytoData 数据集，包含：
- **几何特征**：细胞面积、周长、等效直径、圆形度
- **核特征**：核大小、核质比、核形状不规则度
- **纹理特征**：灰度共生矩阵（GLCM）衍生指标、局部二值模式（LBP）特征

### 3.2 技术路线

#### 3.2.1 数据预处理流程
1. **数据加载与清洗**
   - 排除元信息列（cell_code, cell_id, plate等）
   - 处理缺失值和异常值

2. **数据划分**
   - 训练集：测试集 = 8:2
   - 采用分层抽样确保类别分布一致

3. **特征标准化**
   - 使用StandardScaler标准化特征
   - 消除不同特征间的量纲差异

4. **PCA降维**
   - 保留95%的方差信息
   - 将高维特征降至manageable维度
   - 可视化主成分聚类趋势

#### 3.2.2 类别不平衡处理
- 计算样本权重：使用平方根策略减少权重差异
- 采用balanced策略自动计算样本权重

---

## 4. 模型选择与训练

### 4.1 模型选择
基于项目需求选择两种互补的机器学习模型：

#### 4.1.1 梯度提升决策树（Gradient Boosting Decision Tree, GBDT）
- **优势**：
  - 准确率高，通过不断改进错误提升性能
  - 能处理特征间的复杂关系
  - 提供特征重要性分析
- **工作原理**：
  - 逐步构建决策树，每棵树学习前面树的错误
  - 通过加权平均获得最终预测

#### 4.1.2 多层感知机（Multi-Layer Perceptron, MLP）
- **优势**：
  - 通过非线性激活函数拟合复杂模式
  - 适合处理高维特征数据
- **网络结构**：
  - 隐藏层：(256, 128) 或 (128, 64)
  - 激活函数：ReLU
  - 正则化：L2正则化防止过拟合

### 4.2 超参数优化
采用**5折交叉验证 + 网格搜索（Grid Search）**优化模型参数：

#### GBDT超参数搜索
- **搜索空间**：
  - n_estimators: [100, 200, 300, 500]
  - max_depth: [3, 4, 5, 6]
  - learning_rate: [0.01, 0.05, 0.1, 0.2]
- **最优参数**：`{'n_estimators': 200, 'max_depth': 5, 'learning_rate': 0.05}`

#### MLP超参数搜索
- **搜索空间**：
  - hidden_layer_sizes: [(256, 128), (128, 64), (256,), (128,)]
  - alpha: [1e-4, 5e-4, 1e-3]
  - learning_rate_init: [1e-3, 5e-4]

---

## 5. 结果与分析

### 5.1 PCA可视化分析
通过PCA降维可视化验证了"形态特征可区分类别"的合理性：
- 不同类别细胞在主成分空间中呈现明显的聚类趋势
- 前两个主成分解释了数据的主要方差
- 验证了形态特征的分类价值

### 5.2 模型性能评估

#### 5.2.1 核心评估指标
- **准确率（Accuracy）**：衡量模型整体预测的正确性
- **精确率（Precision）**：衡量正类预测的准确性
- **召回率（Recall）**：衡量正类样本的覆盖率
- **F1分数**：精确率与召回率的调和平均，综合评估模型性能

#### 5.2.2 辅助评估
- **混淆矩阵（Confusion Matrix）**：直观展示模型对每类细胞的预测错误情况
- **特征重要性分析**：识别对分类最重要的形态特征
- **ROC曲线与AUC**：评估模型的分类性能

### 5.3 主要发现

#### 5.3.1 分类效果
1. **类别区分明显**：PCA可视化显示不同类别细胞在形态特征空间中具有明显的分离性
2. **模型性能优秀**：优化后的模型在测试集上表现良好
3. **特征重要性**：识别出对细胞分类最关键的形态特征

#### 5.3.2 模型对比
- **GBDT模型**：在特征重要性分析方面表现突出，能够识别关键形态特征
- **MLP模型**：通过非线性拟合捕获特征间的复杂关系

---

## 6. 技术创新点

### 6.1 完整的机器学习流程
- 从数据预处理到模型部署的完整pipeline
- 系统性的超参数优化策略
- 多维度的模型评估体系

### 6.2 类别不平衡处理
- 采用样本权重策略处理数据不平衡
- 使用分层抽样确保训练测试集分布一致

### 6.3 可解释性分析
- PCA可视化验证特征分类能力
- 特征重要性分析提供生物学解释
- 混淆矩阵分析模型预测模式

---

## 7. 局限性与改进方向

### 7.1 当前局限性
1. **数据集规模**：有限的数据量可能影响模型的泛化能力
2. **特征工程**：主要依赖预计算特征，缺乏原始图像特征提取
3. **模型复杂度**：需要平衡模型性能与计算成本

### 7.2 改进方向
1. **扩展数据集**：增加更多细胞类型和状态的样本
2. **深度学习**：探索卷积神经网络（CNN）直接处理原始图像
3. **特征工程**：从原始显微镜图像提取自定义形态特征
4. **集成方法**：结合多种模型的预测结果

---

## 8. 项目总结

### 8.1 成果总结
本项目成功实现了基于形态特征的细胞自动分类，主要成果包括：
1. **验证了假设**：形态特征确实可以有效区分不同细胞类型
2. **建立了流程**：完整的机器学习分析pipeline
3. **优化了模型**：通过系统性超参数搜索获得最优模型
4. **提供了工具**：可部署的分类模型和分析框架

### 8.2 应用价值
1. **科研价值**：为细胞生物学研究提供自动化分析工具
2. **临床价值**：可应用于病理切片分析和疾病诊断
3. **药物筛选**：支持基于细胞形态变化的药物效果评估
4. **技术示范**：展示了机器学习在生物医学图像分析中的应用

### 8.3 学习收获
通过本项目，深入理解了：
- 机器学习在生物医学领域的应用方法
- 数据预处理和特征工程的重要性
- 模型选择和超参数优化的策略
- 模型评估和结果解释的方法

---

## 9. 附录

### 9.1 技术栈
- **编程语言**：Python
- **机器学习框架**：scikit-learn
- **数据处理**：pandas, numpy
- **可视化**：matplotlib, seaborn
- **开发环境**：Jupyter Notebook

### 9.2 代码结构
```
project/
├── 01_data_preprocessing/
│   ├── 01_data_split.ipynb
│   ├── 02_feature_selection.ipynb
│   ├── 03_pca_analysis.ipynb
│   └── combined_analysis.ipynb
├── 02_models/
│   ├── 01_gradient_boosting.ipynb
│   └── 02_mlp_classifier.ipynb
├── 03_experiments/
│   ├── 01_smote_oversampling.ipynb
│   └── 02_hyperparameter_tuning.ipynb
└── 04_docs/
    └── 各种文档和报告
```

---

**项目完成日期**：2025年12月26日  
